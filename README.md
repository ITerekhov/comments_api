# comments_api
## Тестовое задание: реализация системы комментариев с использованием Django + Postgresql
### Установка и запуск
Для развёртывания приложения будем использовать возможности docker-compose. Перед началом убедитесь что у вас установлен docker:
```
$ docker --version
```
И docker-compose:
```
$ docker-compose --version
```
Если не установлен, можете воспользоваться [официальным гайдом](https://docs.docker.com/compose/install/).
Для загрузки чувствительных данных понадобится файл *.env*. Скопируйте его в *comments_api/*, или если его у вас нет, создайте и заполните по примеру:
```
POSTGRES_NAME=your value
POSTGRES_USER=your value
POSTGRES_PASSWORD=your value
POSTGRES_DB=your value
DEBUG=False
```
По умолчанию приложение будет работать только локально. Если хотите запустить его для удалённого доступа, добавьте в *.env* строку:
```
ALLOWED_HOSTS=your hostname or ip address
```
Далее введите в консоли команду:
```
$ docker-compose up -d --build
```
Если запускаете приложение в первый раз, необходимо выполнить миграции:
```
$ docker-compose run web python manage.py migrate --noinput
```
На этом этапе приложение бдует работать на указанном вами хосте, или на localhost по умолчанию. Для проверки можете выполнить
```
docker-compose top
```
### Функционал
В приложении реализована логика работы с постами и текстовыми комментариями к ним:
- `your_host:your_port/api/posts`
Принимает GET запрос, по умолчанию возвращает список всех постов с комментариями до 3 уровня вложенности включительно. Можно передать в параметрах название поста по ключу `title`, тогда выполнится поиск по соответствию запросу.
- `your_host:your_port/api/add_new_post`
Принимает POST запрос, в теле ожидается json в формате:
```
{   "title": "some title",
    "text": "some text"}
```
- `your_host:your_port/api/reply_to_post`
Принимает POST запрос, в теле ожидается json в формате:
```
{   "text": "my important opinion about post",
    "post_id": "some post_id",
    "parent": "some parent_id"}
```
Параметр `parent` означает комментарий, на который вы отвечаете. Он опционален, поэтому если вы отвечаете на сам пост, то его передавать не нужно.
- `your_host:your_port/api/comment`
Принимает GET запрос, обязательным параметром принимает id комментария по ключу `id`. Возвращает запрошенный комментарий, а также все ответы на него, независимо от уровня аложенности.
### Более подробно и наглядно с функционалом приложения можете ознакомиться с помощью [Postman-коллекции](https://www.getpostman.com/collections/c6f9c3bd3d00c311ef70)
Для этого нужно авторизоваться на их [платформе](https://www.postman.com/), зайти в свое рабочее пространство и выбрав import -> link вставить ссылку оставленнную выше.
